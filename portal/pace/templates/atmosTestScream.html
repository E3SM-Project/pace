{% extends "layout.html" %}
{% block content %}
{% block topcontent %}
<link rel="stylesheet" type="text/css" href="/static/css/mtGeneral.css" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.bundle.min.js"></script>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<link href="https://unpkg.com/tabulator-tables@5.0.7/dist/css/tabulator.min.css" rel="stylesheet">
<script type="text/javascript" src="https://unpkg.com/tabulator-tables@5.0.7/dist/js/tabulator.min.js"></script>
{% endblock topcontent %}

<p>
    <div style="overflow:hidden; border: 4px solid black; margin-bottom:75px">
        <h3 style="text-align:center">ATM Process Distribution - Stacked graph</h3>
        <br>
        <details open>
            <summary style="text-align:center; cursor: pointer;"><u>Collapse</u></summary>
            <div id="compTable"></div>
            <span style="color:crimson" id="note"></span>
        </details>
        <br>
        <br>
        <div id="stacktimes" style="border:1px solid black; border-radius: 25px"></div>
    </div>
    <br>
</p>
<script>
var jsonData = {{jd|tojson}}
var expid = String({{expids}})

//load google charts to create bar charts
google.charts.load('current', {packages: ['corechart', 'bar']});
google.charts.setOnLoadCallback(atmStackedTime);

var colorSeq = ["#882E72","#1965B0","#7BAFDE","#4EB265","#CAE0AB","#F7F056","#F4A736","#E8601C","#DC050C","#72190E"]

function atmStackedTime(){

    var row = []
    var column = []

    column.push('Exp ID')
    row.push(expid)

    for (var key in jsonData){
        column.push(jsonData[key]['label'])
        row.push(jsonData[key]['atm_time'])
    }
    console.log(column)
    console.log(row)
    var data = google.visualization.arrayToDataTable([
        column,
        row
    ]);
    var materialOptions = {    
        isStacked: 'percent',
        
        legend:{
            position: 'top',
            positionalignment: 'center',
            maxLines:3
        },
        hAxis: {
            minValue: 0,
        },
        vAxis: {
            title: 'Experiment ID',
            textPosition: 'out'
        },
        colors: colorSeq,
        bars: 'horizontal'
    };
    //var materialChart = new google.charts.Bar(document.getElementById('stacktimes'));
    var materialChart = new google.visualization.BarChart(document.getElementById('stacktimes'));
    materialChart.draw(data, materialOptions);
}
</script>
{% endblock %}