{% extends "layout.html" %}
{% block content %}
{% block topcontent %}

<style>
.runtimeTable th, .runtimeTable td{
    border:1px solid;
}
.runtimeTable{
    background-color:#F0F0F0;
    font-family:monospace;
    color:#444;
}

.inBlock{
    display:inline-block;
}
#runtimeImg{
    width:auto;
    max-width:7in;
    height:auto;
    /*margin-top:-25%*/
}
</style>
{% endblock topcontent %}

<h3 style="text-align:center">Experiment Details</h3>

<table style="margin-left:11%">
    <tbody>
        <tr>
        <td class="inBlock">
            <!--Pre's take *everything literally, so everyting inside this pre is unformatted...-->
            <pre style="width:auto;background-color:#EEE;border-radius:10px"><code id="expsummary">
Id: {{exp.expid}}
User: {{exp.user}} 
Machine: {{exp.machine}} 
Compset: {{exp.compset}} 
Case: {{exp.case}}
Res: {{exp.res}} 
Runtime: {{runtime[0].seconds}} seconds
Throughput: {{exp.model_throughput}} SYPD
Total PEs: {{exp.total_pes_active}}
Run length: {{exp.run_length}} 
MPI tasks/node: {{exp.mpi_tasks_per_node}}
Summary Charts: {% for rank in ranks -%}<a href="/summary/{{expid}}/{{rank.rank}}">{{rank.rank}}</a> &nbsp;
            {%- endfor %}
<a href="/static/data/experiment-{{exp.lid}}.zip">Download Raw Data</a>
            </code></pre>
        </td>
        <td class="inBlock">
            <img id="runtimeImg"/>
        </td>
        <td class="inBlock">
            <table class="runtimeTable">
                <thead>
                    <tr>
                    <th>Component</th><th>Run time(s)</th>
                    </tr>
                </thead>
                <tbody>
                {%for element in runtime%}
                <tr>
                    <td>{{element.component}}</td><td>{{element.seconds}}</td>
                </tr>
                {%endfor%}
                </tbody>
            </table>
        </td>
        </tr>
    </tbody>
</table>

<script>
var imgLink = detectRootUrl()+"svg/runtime/{{expid}}";
runtimeImg.src=imgLink;

//Format the expsummary!
{
    let lines = expsummary.innerHTML.split("\n");
    expsummary.innerHTML="";
    lines.forEach(element=>{
        elSplit = element.split(":");
        expsummary.innerHTML+="<span style='color:crimson'>"+elSplit[0]+""+(elSplit[1]?":</span><b>"+elSplit[1]+"</b>\n":"</span>");
    });
}
</script>

{% endblock %}
